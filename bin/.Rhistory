library(tidyverse)
read_stats <- read_tsv("/mnt/tempdata/pipelines/artic_nextflow_sample_sheet/analysis/TEST/minion/read_stats/MPOX_006_combined_read_stats.tsv")
read_stats <- read_tsv("/mnt/tempdata/pipelines/artic_nextflow_sample_sheet/analysis/TEST/minion/read_stats/TEST_combined_read_stats.tsv")
read_stats <- read_tsv("/mnt/tempdata/pipelines/artic_nextflow_sample_sheet/analysis/TEST/minion/read_stats/TEST_combined_read_stats.tsv")
sample_sheet <- read_csv2("/mnt/tempdata/pipelines/artic_nextflow_sample_sheet/data/samplesheets/TEST_samplesheet.csv")
nextclade <- read_csv2("/mnt/tempdata/pipelines/artic_nextflow_sample_sheet/analysis/TEST/nextclade_output/nextclade_output/TEST.csv")
View(nextclade)
View(read_stats)
View(sample_sheet)
View(read_stats)
nextclade$seqName <- gsub("/NC_063383/ARTIC/clair3 NC_063383", "", nextclade$seqName)
read_stats <- read_stats %>% rename(
sample_id = Sample
) %>%
separate(
sample_id, into = c("barcode", "sample_id"), sep = "_"
) %>%
mutate(sample_id = as.character(sample_id))
nextclade <- nextclade %>%  rename(
sample_id = seqName
) %>%
select(sample_id, clade, lineage, coverage) %>%
mutate(coverage = as.numeric(coverage)) %>%
mutate(coverage = coverage*100) %>%
separate(sample_id, into = c("barcode", "sample_id"), sep = "_") %>%
mutate(sample_id = as.character(sample_id))
combined_all <- left_join(
sample_sheet, nextclade, by = c("sample_id", "barcode")) %>%
left_join(
., read_stats, by = c("sample_id", "barcode")
)
View(sample_sheet)
View(nextclade)
View(nextclade)
read_stats <- read_tsv("/mnt/tempdata/pipelines/artic_nextflow_sample_sheet/analysis/TEST/minion/read_stats/TEST_combined_read_stats.tsv")
sample_sheet <- read_csv2("/mnt/tempdata/pipelines/artic_nextflow_sample_sheet/data/samplesheets/TEST_samplesheet.csv")
nextclade <- read_csv2("/mnt/tempdata/pipelines/artic_nextflow_sample_sheet/analysis/TEST/nextclade_output/nextclade_output/TEST.csv")
nextclade$seqName <- gsub("/NC_063383/ARTIC/clair3 NC_063383", "", nextclade$seqName)
read_stats <- read_stats %>% rename(
sample_id = Sample
) %>%
separate(
sample_id, into = c("barcode", "sample_id"), sep = "_"
) %>%
mutate(sample_id = as.character(sample_id))
nextclade <- nextclade %>%  rename(
sample_id = seqName
) %>%
select(sample_id, clade, lineage, coverage) %>%
mutate(coverage = as.numeric(coverage)) %>%
mutate(coverage = coverage*100) %>%
separate(sample_id, into = c("barcode", "sample_id"), sep = "_") %>%
mutate(sample_id = as.numeric(sample_id))
combined_all <- left_join(
sample_sheet, nextclade, by = c("sample_id", "barcode")) %>%
left_join(
., read_stats, by = c("sample_id", "barcode")
)
View(sample_sheet)
View(nextclade)
combined_all <- left_join(
sample_sheet, nextclade, by = c("sample_id", "barcode"))
View(combined_all)
View(read_stats)
